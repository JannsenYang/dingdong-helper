# dingdong-helper
叮咚自动下单 自动将购物车能买的商品全部下单 只需自行编辑购物车和最后支付即可

### 步骤
1. 通过Charles(mac)、fiddler(windows)等抓包工具抓取微信中叮咚买菜小程序中的接口信息中的用户信息配置到UserConfig.java中，比如openId、userId，详情见下截图，此操作每个用户只需要做一次，如果不会抓包请自行学习。
2. 将需要买的菜自行通过APP放入购物车并勾选
3. 等待叮咚开放购买并运行该程序，该程序会自行更新购物车（新增或者无货）和配送时间
4. 等待程序结束，如果成功则自行打开叮咚买菜app-我的订单-待支付-点击支付

### 程序自动结束的几个条件
1. 购物车无可购买商品
2. 下单成功
3. 无配送时间还会继续，为了考虑在叮咚开放时间前提前打开程序

### 思路
虽然我家吃的很多，但是时间长了也受不了这几天每天早上起来抢菜，手都点抽经了都买不到，看着购物车里的菜越来越少心急如焚，作为程序员只能靠自己的双手了，吃完午饭开干，晚上6点成功下单
1. 抓app的包没抓到
2. 抓小程序的包可以，但是小程序无法做登录，拿不到open id，所以只能通过自行抓包解决。另看到请求参数中有一些签名字段，心想麻烦哟
3. 准备研究如何签名，解包微信小程序，初步研究签名相关代码，搞不定就去研究app hook，但那耗费精力太大，留着当后手
4. 先写一个获取地址的请求，发现那几个看着像签名的参数可以不用传，省了一大笔精力，应该一开始就用Charles的breakpoint删除参数再repeat尝试无签名是否可访问，被唬住了，早知道就可以省略步骤3
5. 梳理下单需要的参数和步骤，数据量非常庞大，眼睛都看晕了，需要细心
6. 看到下单成功很开心，这就是乐趣

最后希望疫情早日结束大家伙都能吃上饭


### 抓包截图 将你的信息填入
![请求头信息](https://github.com/JannsenYang/dingdong-helper/blob/5b72bee57c06c48174b639658ab94d765b744274/headers.jpeg)
![请求体信息](https://github.com/JannsenYang/dingdong-helper/blob/5b72bee57c06c48174b639658ab94d765b744274/body.jpeg)
